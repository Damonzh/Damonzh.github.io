<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>VectorDrawable怎么玩 | DamonZhang</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="摘要从5.0(API等级21)开始，android开始支持矢量图了。关于什么是矢量图以及矢量图有什么优缺点不在本文的涉及范围之内，具体可以参考矢量图百科。不过这里要提一下它的优点：  

保存最少的信息，文件大小比位图要小，并且文件大小与物体的大小无关
任意放大矢量图形，不会丢失细节或影响清晰度，因为矢量图形是与分辨率无关的。">
<meta property="og:type" content="article">
<meta property="og:title" content="VectorDrawable怎么玩">
<meta property="og:url" content="http://yoursite.com/2016/03/14/how-to-use-vector-drawable/index.html">
<meta property="og:site_name" content="DamonZhang">
<meta property="og:description" content="摘要从5.0(API等级21)开始，android开始支持矢量图了。关于什么是矢量图以及矢量图有什么优缺点不在本文的涉及范围之内，具体可以参考矢量图百科。不过这里要提一下它的优点：  

保存最少的信息，文件大小比位图要小，并且文件大小与物体的大小无关
任意放大矢量图形，不会丢失细节或影响清晰度，因为矢量图形是与分辨率无关的。">
<meta property="og:image" content="http://damonzh.github.io/2016/03/14/how-to-use-vector-drawable/png_original.png">
<meta property="og:image" content="http://damonzh.github.io/2016/03/14/how-to-use-vector-drawable/png_scaled.png">
<meta property="og:image" content="http://damonzh.github.io/2016/03/14/how-to-use-vector-drawable/vertor_original.png">
<meta property="og:image" content="http://damonzh.github.io/2016/03/14/how-to-use-vector-drawable/vector_scaled.png">
<meta property="og:image" content="http://damonzh.github.io/2016/03/14/how-to-use-vector-drawable/animated_vector.gif">
<meta property="og:updated_time" content="2016-03-14T10:25:28.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="VectorDrawable怎么玩">
<meta name="twitter:description" content="摘要从5.0(API等级21)开始，android开始支持矢量图了。关于什么是矢量图以及矢量图有什么优缺点不在本文的涉及范围之内，具体可以参考矢量图百科。不过这里要提一下它的优点：  

保存最少的信息，文件大小比位图要小，并且文件大小与物体的大小无关
任意放大矢量图形，不会丢失细节或影响清晰度，因为矢量图形是与分辨率无关的。">
  
  
    <link rel="icon" href="/img/avatar.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="/img/avatar.png" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">Damon Zhang</a></h1>
		</hgroup>

		
		<p class="header-subtitle">每天进步,持之以恒</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/Android/" style="font-size: 20px;">Android</a> <a href="/tags/AnimatedVectorDrawable/" style="font-size: 10px;">AnimatedVectorDrawable</a> <a href="/tags/EventBus/" style="font-size: 12.5px;">EventBus</a> <a href="/tags/Gradle/" style="font-size: 15px;">Gradle</a> <a href="/tags/Handler/" style="font-size: 10px;">Handler</a> <a href="/tags/Toolbar/" style="font-size: 12.5px;">Toolbar</a> <a href="/tags/VectorDrawable/" style="font-size: 10px;">VectorDrawable</a> <a href="/tags/微信支付/" style="font-size: 10px;">微信支付</a> <a href="/tags/源码/" style="font-size: 12.5px;">源码</a> <a href="/tags/译文/" style="font-size: 17.5px;">译文</a>
					</div>
				</section>
				
				
				

				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">Damon Zhang</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="/img/avatar.png" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">Damon Zhang</h1>
			</hgroup>
			
			<p class="header-subtitle">每天进步,持之以恒</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap"><article id="post-how-to-use-vector-drawable" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/14/how-to-use-vector-drawable/" class="article-date">
  	<time datetime="2016-03-14T07:06:33.000Z" itemprop="datePublished">2016-03-14</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      VectorDrawable怎么玩
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/AnimatedVectorDrawable/">AnimatedVectorDrawable</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/VectorDrawable/">VectorDrawable</a></li></ul>
	</div>

        

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="u6458_u8981"><a href="#u6458_u8981" class="headerlink" title="摘要"></a>摘要</h3><p>从5.0(API等级21)开始，android开始支持矢量图了。关于什么是矢量图以及矢量图有什么优缺点不在本文的涉及范围之内，具体可以参考<a href="https://zh.wikipedia.org/wiki/%E7%9F%A2%E9%87%8F%E5%9B%BE%E5%BD%A2" target="_blank" rel="external">矢量图百科</a>。不过这里要提一下它的优点：  </p>
<ul>
<li>保存最少的信息，文件大小比位图要小，并且文件大小与物体的大小无关</li>
<li>任意放大矢量图形，不会丢失细节或影响清晰度，因为矢量图形是与分辨率无关的。  </li>
</ul>
<a id="more"></a>
<p>从以上两个优点来看，在项目中使用矢量图至少可以缩小我们apk包的尺寸，而且可以在屏幕适配时提供很大的方便，因为矢量图是分辨率无关的。</p>
<p>前面也说了，矢量图从21才开始支持。那么如果我想往下兼容改怎么办呢？这个问题要放在以前的话，我会说github下就有你要的答案。但现在我不会这么说，因为前段时间Google升级了<a href="http://android-developers.blogspot.jp/2016/02/android-support-library-232.html" target="_blank" rel="external">support library</a>，官方向后兼容了矢量图的使用。要问兼容到哪个版本，我告诉你是API7(是不是已经满足了你的使用)。  </p>
<p>好了，下面我们就来说说怎么在项目中使用矢量图。  </p>
<h3 id="VectorDrawable_u7684_u4F7F_u7528"><a href="#VectorDrawable_u7684_u4F7F_u7528" class="headerlink" title="VectorDrawable的使用"></a>VectorDrawable的使用</h3><p>按照官方的说法，要在低版本上使用矢量图，需要在项目中引入新的兼容库support-vector-drawable，并且appcompat-v7库的版本要在23.2.0+(写文章这会23.2.1已经发布了)。而且你还要修改下gradle的相关配置，不要让gradle在构建的时候为你在低版本(API21以下)的情况下生成针对于不同密度的png文件，因为android studio1.4的时候支持了矢量图。  </p>
<h5 id="u4FEE_u6539appcompat-v7_u7684_u7248_u672C"><a href="#u4FEE_u6539appcompat-v7_u7684_u7248_u672C" class="headerlink" title="修改appcompat-v7的版本"></a>修改appcompat-v7的版本</h5><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">compile</span> <span class="string">'com.android.support:appcompat-v7:23.2.0'</span></span><br></pre></td></tr></table></figure>
<p><strong>NOTE:</strong> 这里我只引入了23.2.0版本的appcompat-v7库，同步gradle后就编译出了support-vector-drawable-23.2.0和animated-vector-drawable-23.2.0这两个库。</p>
<h5 id="u4FEE_u6539gradle_u914D_u7F6E_u6587_u4EF6"><a href="#u4FEE_u6539gradle_u914D_u7F6E_u6587_u4EF6" class="headerlink" title="修改gradle配置文件"></a>修改gradle配置文件</h5><p>如果你的gradle插件的版本为2.0以下，你应该这么修改  </p>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">android &#123;</span><br><span class="line">  defaultConfig &#123;</span><br><span class="line">    // 不让gradle自动生成不同屏幕分辨率的png图</span><br><span class="line">    generatedDensities = []</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  aaptOptions &#123;</span><br><span class="line">    additionalParameters <span class="string">"--no-version-vectors"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果你的gradle插件版本是2.0+，你 应该这么修改  </p>
<figure class="highlight puppet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="name">android</span> &#123;</span><br><span class="line">  defaultConfig &#123;</span><br><span class="line">    vectorDrawables.useSupportLibrary = <span class="keyword">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>经过上面这几步的修改，你就可以在项目中使用数量图了。那么，下面我们就正式来说说怎么使用。  </p>
<p>android studio为我们提供了一个Vector Asset Studio的工具，让我么可以从material icon和svg文件生成矢量图。具体用法可以参考<a href="http://developer.android.com/tools/help/vector-asset-studio.html" target="_blank" rel="external">官方的说明文档</a>，这里就不多说了。  </p>
<p>Android中矢量图是以xml文档的形式存在的，像下面这样就定义了一个矢量图，里面包含了关于该矢量图的数据信息。  </p>
<figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- res/drawable/heart.xml --&gt;</span><br><span class="line">&lt;vector xmlns:android="http://schemas.android.com/apk/res/android"</span><br><span class="line">    android:width="24dp"</span><br><span class="line">    android:height="24dp"</span><br><span class="line">    android:viewportHeight="24.0"</span><br><span class="line">    android:viewportWidth="24.0"&gt;</span><br><span class="line">    &lt;path</span><br><span class="line">        android:fillColor="#FF000000"</span><br><span class="line">        android:pathData="M<span class="number">11.99,2C6</span>.<span class="number">47,2 2,6</span>.<span class="number">48 2,12s4</span>.<span class="number">47,10 9.99</span>,<span class="number">10C17.52,22</span> <span class="number">22,17.52 22</span>,<span class="number">12S17.52,2</span> 11.99,2zM12,20c-4.42,0 -8,-3.58 -8,-8s3.58,-8 8,-<span class="number">8 8,3.58</span> 8,8 -3.58,8 -8,8zM<span class="number">15.5,11c0</span>.<span class="number">83,0 1.5</span>,-<span class="number">0.67 1.5</span>,-<span class="number">1.5S16.33</span>,<span class="number">8 15.5,8</span> <span class="number">14,8.67 14</span>,<span class="number">9.5s0.67</span>,<span class="number">1.5 1.5</span>,1.5zM<span class="number">8.5,11c0</span>.<span class="number">83,0 1.5</span>,-<span class="number">0.67 1.5</span>,-<span class="number">1.5S9.33</span>,<span class="number">8 8.5,8</span> <span class="number">7,8.67 7</span>,<span class="number">9.5 7.67</span>,<span class="number">11 8.5,11</span>zM<span class="number">12,17.5c2</span>.<span class="number">33,0 4.31</span>,-<span class="number">1.46 5.11</span>,-<span class="number">3.5L6.89</span>,<span class="number">14c0.8,2</span>.<span class="number">04 2.78,3</span>.<span class="number">5 5.11,3</span>.5z" /&gt;</span><br><span class="line">&lt;/vector&gt;</span><br></pre></td></tr></table></figure>
<p>这是我通过material icon生成的，它在android中对应着VectorDrawable这个类，也就是兼容包中的VectorDrawableCompat这个类。  </p>
<p>定义好矢量图形后，我们就可以向普通的图形那样来使用它了。不过有几点需要注意：  </p>
<ul>
<li>使用android:src属性的地方需要替换为app:srcCompat属性  </li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="pi">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">RelativeLayout</span> <span class="attribute">xmlns:android</span>=<span class="value">"http://schemas.android.com/apk/res/android"</span></span><br><span class="line">    <span class="attribute">xmlns:tools</span>=<span class="value">"http://schemas.android.com/tools"</span></span><br><span class="line">    <span class="attribute">xmlns:app</span>=<span class="value">"http://schemas.android.com/apk/res-auto"</span></span><br><span class="line">    <span class="attribute">android:layout_width</span>=<span class="value">"match_parent"</span></span><br><span class="line">    <span class="attribute">android:layout_height</span>=<span class="value">"match_parent"</span></span><br><span class="line">    <span class="attribute">android:paddingBottom</span>=<span class="value">"@dimen/activity_vertical_margin"</span></span><br><span class="line">    <span class="attribute">android:paddingLeft</span>=<span class="value">"@dimen/activity_horizontal_margin"</span></span><br><span class="line">    <span class="attribute">android:paddingRight</span>=<span class="value">"@dimen/activity_horizontal_margin"</span></span><br><span class="line">    <span class="attribute">android:paddingTop</span>=<span class="value">"@dimen/activity_vertical_margin"</span></span><br><span class="line">    <span class="attribute">tools:context</span>=<span class="value">"com.damon.vectordrawabledemo.MainActivity"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="title">ImageView</span></span><br><span class="line">        <span class="attribute">android:layout_width</span>=<span class="value">"wrap_content"</span></span><br><span class="line">        <span class="attribute">android:layout_height</span>=<span class="value">"wrap_content"</span></span><br><span class="line">        <span class="attribute">app:srcCompat</span>=<span class="value">"@drawable/ic_mood_black_24dp"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">RelativeLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>在非src属性的地方使用矢量图时，需要将矢量图用drawable容器(如StateListDrawable, InsetDrawable, LayerDrawable, LevelListDrawable, 和RotateDrawable)包裹起来使用。否则会在低版本的情况下报错。</li>
</ul>
<p>而在代码中的使用和普通的png图没什么区别，调用的是同样的API。  </p>
<p>这样我们就把矢量图引入到我们的项目中了，下面我贴几张图来对比下矢量图和png图的不同，以此来展示下矢量图的优点。  </p>
<p>首先是png的原图和放大图  </p>
<p><img src="http://damonzh.github.io/2016/03/14/how-to-use-vector-drawable/png_original.png" alt=""><br><img src="http://damonzh.github.io/2016/03/14/how-to-use-vector-drawable/png_scaled.png" alt="">  </p>
<p>其次是矢量图的原图和放大图  </p>
<p><img src="http://damonzh.github.io/2016/03/14/how-to-use-vector-drawable/vertor_original.png" alt=""><br><img src="http://damonzh.github.io/2016/03/14/how-to-use-vector-drawable/vector_scaled.png" alt="">  </p>
<p>对比一目了然。而且矢量图的xml的大小只有655个字节，而不同分辨率的png的大小加起来有好几k。矢量图只需要维护一个xml，而png需要维护多个图形资源。  </p>
<p>矢量图xml文件支持的标签以及属性可以参考<a href="http://developer.android.com/reference/android/graphics/drawable/VectorDrawable.html" target="_blank" rel="external">这里</a>，包括了常见的填充、描边、着色等。</p>
<h3 id="u4F7F_u7528_u77E2_u91CF_u56FE_u5236_u4F5C_u52A8_u753B"><a href="#u4F7F_u7528_u77E2_u91CF_u56FE_u5236_u4F5C_u52A8_u753B" class="headerlink" title="使用矢量图制作动画"></a>使用矢量图制作动画</h3><p>23.2的支持库同样也放出了矢量图动画对应的兼容版本AnimatedVectorDrawableCompat，对应的兼容包是animated-vector-drawable，xml标签则是animated-vector。AnimatedVectorDrawableCompat能够以属性动画的形式来驱动VectorDrawable实现动画，具体来说需要分三步走：  </p>
<ul>
<li>定义一个VectorDrawableCompat的xml  </li>
</ul>
<figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;vector xmlns:android="http://schemas.android.com/apk/res/android"</span><br><span class="line">	&lt;!-- 图片本身的大小 --&gt;</span><br><span class="line">    android:width="500px"</span><br><span class="line">    android:height="500px"</span><br><span class="line">    &lt;!-- 画布的大小 --&gt;</span><br><span class="line">    android:viewportHeight="500"</span><br><span class="line">    android:viewportWidth="500"&gt;</span><br><span class="line">    &lt;!-- 用来把多个path或者subgroup组合起来，group提供了一些属性比如旋转、缩放、平移。这些属性值得变化会反应在它内部的path和subgroup元素上--&gt;</span><br><span class="line">    &lt;group</span><br><span class="line">        android:scaleX="5.0"</span><br><span class="line">        android:scaleY="5.0"&gt;</span><br><span class="line">        &lt;!-- 这里group和path有一个name属性，这个属性用来在使用动画时指定动画要驱动的对象 --&gt;</span><br><span class="line">        &lt;path</span><br><span class="line">            android:name="star"</span><br><span class="line">            android:pathData="M <span class="number">50.0,90.0</span> L <span class="number">82.91935463</span><span class="number">57,27.27741</span>01308 L <span class="number">12.59935029</span><span class="number">26,35.81580</span>45183 L <span class="number">59.57262657</span><span class="number">15,88.83767</span>2697 L <span class="number">76.52490632</span><span class="number">96,20.05957</span>00732 L <span class="number">10.29164503</span><span class="number">61,45.178532</span>7898 L <span class="number">68.58892688</span><span class="number">18,85.418241</span>0261 L <span class="number">68.58892688</span><span class="number">18,14.58175</span>89739 L <span class="number">10.29164503</span><span class="number">61,54.82146</span>72102 L <span class="number">76.52490632</span><span class="number">96,79.94042</span>99268 L <span class="number">59.57262657</span><span class="number">15,11.162327</span>303 L <span class="number">12.59935029</span><span class="number">26,64.184195</span>4817 L <span class="number">82.91935463</span><span class="number">57,72.72258</span>98692 L <span class="number">50.0,10.0</span> L <span class="number">17.08064536</span><span class="number">43,72.72258</span>98692 L <span class="number">87.40064970</span><span class="number">74,64.184195</span>4817 L <span class="number">40.42737342</span><span class="number">85,11.162327</span>303 L <span class="number">23.47509367</span><span class="number">04,79.94042</span>99268 L <span class="number">89.70835496</span><span class="number">39,54.82146</span>72102 L <span class="number">31.411073118</span><span class="number">2,14.58175</span>89739 L <span class="number">31.411073118</span><span class="number">2,85.418241</span>0261 L <span class="number">89.70835496</span><span class="number">39,45.178532</span>7898 L <span class="number">23.47509367</span><span class="number">04,20.05957</span>00732 L <span class="number">40.42737342</span><span class="number">85,88.83767</span>2697 L <span class="number">87.40064970</span><span class="number">74,35.81580</span>45183 L <span class="number">17.08064536</span><span class="number">43,27.27741</span>01308 L <span class="number">50.0,90.0</span>Z"</span><br><span class="line">            android:strokeColor="@color/colorAccent"</span><br><span class="line">            android:strokeWidth="2" /&gt;</span><br><span class="line">    &lt;/group&gt;</span><br><span class="line">&lt;/vector&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>定义AnimatedVectorDrawableCompat的xml  </li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="pi">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">animated-vector</span> <span class="attribute">xmlns:android</span>=<span class="value">"http://schemas.android.com/apk/res/android"</span></span><br><span class="line">    <span class="attribute">android:drawable</span>=<span class="value">"@drawable/vector_drawable"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">target</span></span><br><span class="line">        <span class="attribute">android:name</span>=<span class="value">"star"</span></span><br><span class="line">        <span class="attribute">android:animation</span>=<span class="value">"@animator/star_anim"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">animated-vector</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>可以看到，根元素是animated-vector，并且有一个必须的属性android:drawable用来指定要驱动的矢量图对象。子标签target一方面用来指定要驱动的矢量图内的group和path的名称(这里和VectorDrawableCompat的xml中的group和path名称对应)；另一方面指定要使用哪个属性动画来驱动group和path的属性进行变化来产生动画效果。  </p>
<ul>
<li>创建属性动画  </li>
</ul>
<p>驱动trimPathStart和strokeColor属性的动画  </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="pi">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">set</span> <span class="attribute">xmlns:android</span>=<span class="value">"http://schemas.android.com/apk/res/android"</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">objectAnimator</span></span><br><span class="line">        <span class="attribute">android:duration</span>=<span class="value">"5000"</span></span><br><span class="line">        <span class="attribute">android:propertyName</span>=<span class="value">"trimPathStart"</span></span><br><span class="line">        <span class="attribute">android:repeatCount</span>=<span class="value">"infinite"</span></span><br><span class="line">        <span class="attribute">android:repeatMode</span>=<span class="value">"restart"</span></span><br><span class="line">        <span class="attribute">android:valueFrom</span>=<span class="value">"1"</span></span><br><span class="line">        <span class="attribute">android:valueTo</span>=<span class="value">"0"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">objectAnimator</span></span><br><span class="line">        <span class="attribute">android:duration</span>=<span class="value">"5000"</span></span><br><span class="line">        <span class="attribute">android:propertyName</span>=<span class="value">"strokeColor"</span></span><br><span class="line">        <span class="attribute">android:repeatCount</span>=<span class="value">"infinite"</span></span><br><span class="line">        <span class="attribute">android:repeatMode</span>=<span class="value">"restart"</span></span><br><span class="line">        <span class="attribute">android:valueFrom</span>=<span class="value">"@color/colorAccent"</span></span><br><span class="line">        <span class="attribute">android:valueTo</span>=<span class="value">"@color/colorPrimaryDark"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">set</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p> 这样，准备工作就做好了。我们就可以使用矢量图动画了。把ImageView的src更改为矢量图动画  </p>
 <figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;ImageView</span><br><span class="line">       android:<span class="property">id</span>=<span class="string">"@+id/image_view"</span></span><br><span class="line">       android:layout_width=<span class="string">"200dp"</span></span><br><span class="line">       android:layout_height=<span class="string">"200dp"</span></span><br><span class="line">       app:srcCompat=<span class="string">"@drawable/vector_drawable_anim"</span> /&gt;</span><br></pre></td></tr></table></figure>
<p> 在Java代码中启动动画  </p>
 <figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"> ImageView imageView = (ImageView) findViewById(R.id.image_view);</span><br><span class="line">Drawable drawable = imageView.getDrawable();</span><br><span class="line"><span class="comment">//AnimatedVectorDrawableCompat实现了Animatable接口</span></span><br><span class="line"><span class="keyword">if</span> (drawable <span class="keyword">instanceof</span> Animatable)&#123;</span><br><span class="line">    ((Animatable) drawable).start();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p> 这样就实现了矢量图动画，看看效果图吧。  </p>
<p> <img src="http://damonzh.github.io/2016/03/14/how-to-use-vector-drawable/animated_vector.gif" alt="">  </p>
<p> 好了，关于矢量图以及矢量图动画的使用就说这么多。具体的一些细节以及xml中的其他属性啥的怎么使用可以参考官方文档，自己亲自试一试就会很明了了。源码在<a href="https://github.com/Damonzh/VectorDrawableDemo" target="_blank" rel="external">这里</a>，欢迎star and fork。</p>

      
    </div>
    
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2016/04/04/transition-framework/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption"><</strong>
      <div class="article-nav-title">
        
          使用Transition FrameWork实现有意义的转场动画(译)
        
      </div>
    </a>
  
  
    <a href="/2016/03/10/how-to-use-toolbar-2/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">怎么使用Toolbar之给Toolbar加上动画</div>
      <strong class="article-nav-caption">></strong>
    </a>
  
</nav>

  
</article>


<div class="share">
	<!-- JiaThis Button BEGIN -->
	<div class="jiathis_style">
		<span class="jiathis_txt">分享到：</span>
		<a class="jiathis_button_tsina"></a>
		<a class="jiathis_button_cqq"></a>
		<a class="jiathis_button_douban"></a>
		<a class="jiathis_button_weixin"></a>
		<a class="jiathis_button_tumblr"></a>
		<a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a>
	</div>
	<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=1405949716054953" charset="utf-8"></script>
	<!-- JiaThis Button END -->
</div>



<div class="duoshuo">
	<!-- 多说评论框 start -->
	<div class="ds-thread" data-thread-key="how-to-use-vector-drawable" data-title="VectorDrawable怎么玩" data-url="http://yoursite.com/2016/03/14/how-to-use-vector-drawable/"></div>
	<!-- 多说评论框 end -->
	<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
	<script type="text/javascript">
	var duoshuoQuery = {short_name:"true"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
	<!-- 多说公共JS代码 end -->
</div>




</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2016 Damon Zhang
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: true
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>